{% extends "base.html" %}
{% block title %}Profile{% endblock %}

{% block content %}
<div class="page-card">

  <div class="d-flex align-items-center justify-content-between mb-3">
    <div>
      <h3 class="mb-1" style="font-weight:900;">My Profile</h3>
      <div class="text-muted" style="font-size:13px;">
        View your account information.
      </div>
    </div>
  </div>

  <div class="profile-grid">

    <div class="profile-card">
      <div class="profile-head">
        {% set parts = (user.firstname or '').split() %}
        {% set first = parts[0] if parts|length > 0 else '' %}
        {% set last = parts[-1] if parts|length > 1 else '' %}
        {% set initials = (first[:1] ~ (last[:1] if last else (first[1:2] if first|length > 1 else ''))).upper() %}
        <div class="profile-avatar">{{ initials }}</div>

        <div>
          <div class="profile-name">{{ user.firstname }}</div>
        </div>
      </div>

      <div class="profile-body">
        <div class="profile-field">
          <div class="label">Email</div>
          <div class="value">{{ user.email }}</div>
        </div>

        <div class="profile-field">
          <div class="label">Account Type</div>
          <div class="value">
            {% if user.is_admin %}Admin{% else %}User{% endif %}
          </div>
        </div>

        <div class="mt-3">
          <a class="btn btn-danger btn-sm" href="{{ url_for('auth.logout') }}">
            Logout
          </a>
        </div>
      </div>
    </div>

    <div class="profile-card">
      <div class="profile-body">
        <h5 style="font-weight:900;">Security</h5>
        <div class="alert alert-info">
          Your password is stored securely (hashed).
        </div>

        <form method="POST" class="mt-3">
          <div class="form-group mb-2">
            <label for="current_password">Current Password</label>
            <input
              type="password"
              class="form-control"
              id="current_password"
              name="current_password"
              required
            />
          </div>

          <div class="form-group mb-2">
            <label for="new_password">New Password</label>
            <input
              type="password"
              class="form-control"
              id="new_password"
              name="new_password"
              minlength="7"
              required
            />
          </div>

          <div class="form-group mb-3">
            <label for="confirm_password">Confirm New Password</label>
            <input
              type="password"
              class="form-control"
              id="confirm_password"
              name="confirm_password"
              minlength="7"
              required
            />
          </div>

          <button type="submit" class="btn btn-primary btn-sm">Change Password</button>
        </form>
      </div>
    </div>

  </div>
</div>
{% endblock %}
